version: 2

models:
  - name: rep_category_performance
    description: >
      Daily category-level performance metrics for the Wolt Snack Store.
      Each row represents the performance of a single product category on a given day.
      This reporting model is designed to support analysis of category growth,
      promotional impact, and pricing behavior over time.

    columns:
      - name: category_date_key
        description: >
          Surrogate key representing one category on one calendar date.
          Used as the primary key for this reporting table.
        tests:
          - not_null
          - unique

      - name: order_date
        description: >
          Calendar date on which the orders were placed.
          Derived from the order received timestamp.
        tests:
          - not_null

      - name: category
        description: >
          Product category associated with the items sold.
          Sourced from the item dimension.
        tests:
          - not_null

      - name: revenue
        description: >
          Total item-level revenue generated for the category on the given date.
          Calculated as the sum of item_price_at_purchase multiplied by quantity.
        tests:
          - not_null

      - name: units_sold
        description: >
          Total number of item units sold within the category on the given date.
        tests:
          - not_null

      - name: orders
        description: >
          Number of distinct purchase orders that included at least one item
          from the category on the given date.
        tests:
          - not_null

      - name: distinct_items_sold
        description: >
          Count of distinct items sold within the category on the given date.
        tests:
          - not_null

      - name: promo_units_sold
        description: >
          Total number of units sold as part of promotional orders
          within the category on the given date.
        tests:
          - not_null

      - name: promo_orders
        description: >
          Number of distinct purchase orders that were promotional
          and included items from the category on the given date.
        tests:
          - not_null

      - name: avg_unit_price
        description: >
          Average selling price per unit for the category on the given date.
          Computed as revenue divided by units sold.
        tests:
          - not_null

      - name: promo_unit_share
        description: >
          Share of units sold that were part of promotional orders.
          Calculated as promo_units_sold divided by total units_sold.
        tests:
          - not_null

      - name: promo_order_share
        description: >
          Share of orders that were promotional for the category on the given date.
          Calculated as promo_orders divided by total orders.
        tests:
          - not_null


  - name: rep_item_performance
    description: >
      Daily product-level performance metrics derived from validated purchase
      and item facts. Each row represents one product on one day, aggregating
      revenue, volume, order activity, and promotion exposure. This model is
      designed to identify star products, promotion-driven items, and pricing
      versus volume dynamics within and across categories.

    columns:
      - name: item_date_key
        description: >
          Surrogate key combining item_key and order_date. Uniquely identifies
          a product's performance on a given day.
        tests:
          - not_null
          - unique

      - name: order_date
        description: >
          Calendar date when the purchases occurred.
        tests:
          - not_null

      - name: item_key
        description: >
          Unique identifier of the product. Foreign key to dim_item.
        tests:
          - not_null
          - relationships:
              to: ref('dim_item')
              field: item_key

      - name: item_name_en
        description: >
          English product name used for reporting and analysis.
        tests:
          - not_null

      - name: category
        description: >
          Product category the item belongs to.
        tests:
          - not_null

      - name: revenue
        description: >
          Total revenue generated by the item on the given day, calculated as
          quantity multiplied by item_price_at_purchase.
        tests:
          - not_null

      - name: units_sold
        description: >
          Total number of units sold for the item on the given day.
        tests:
          - not_null

      - name: orders
        description: >
          Number of distinct purchase orders containing the item on the given day.
        tests:
          - not_null

      - name: promo_units_sold
        description: >
          Number of units sold in orders that contained at least one promotion.
        tests:
          - not_null

      - name: promo_orders
        description: >
          Number of orders containing the item that were flagged as promotional orders.
        tests:
          - not_null

      - name: avg_unit_price
        description: >
          Average unit price paid for the item on the given day.
          Calculated as revenue divided by units_sold.
        tests:
          - not_null

      - name: promo_unit_share
        description: >
          Share of units sold that were part of promotional orders.
        tests:
          - not_null

      - name: promo_order_share
        description: >
          Share of orders containing the item that were promotional orders.
        tests:
          - not_null
